24-12-11 16:39:15.341 - INFO:   name: SR3
  phase: train
  gpu_ids: [0, 1, 2, 3]
  path:[
    log: experiments/SR3_241211_163915/logs
    tb_logger: experiments/SR3_241211_163915/tb_logger
    results: experiments/SR3_241211_163915/results
    checkpoint: experiments/SR3_241211_163915/checkpoint
    resume_state: None
    experiments_root: experiments/SR3_241211_163915
  ]
  datasets:[
    train:[
      name: MGH_train
      mode: HR
      dataroot: /data/wtl/SR_Data/
      datatype: lmdb
      l_resolution: 128
      r_resolution: 128
      batch_size: 128
      num_workers: 32
      use_shuffle: True
      data_len: -1
    ]
    val:[
      name: MGH_val
      mode: LRHR
      dataroot: /data/wtl/SR_data_val/
      datatype: lmdb
      l_resolution: 128
      r_resolution: 128
      data_len: 3
    ]
  ]
  model:[
    which_model_G: sr3
    finetune_norm: False
    unet:[
      in_channel: 4
      out_channel: 1
      inner_channel: 64
      channel_multiplier: [1, 2, 4, 8, 8]
      attn_res: [16]
      res_blocks: 2
      dropout: 0.2
    ]
    beta_schedule:[
      train:[
        schedule: linear
        n_timestep: 1000
        linear_start: 1e-06
        linear_end: 0.01
      ]
      val:[
        schedule: linear
        n_timestep: 1000
        linear_start: 1e-06
        linear_end: 0.01
      ]
    ]
    diffusion:[
      image_size: 128
      channels: 1
      conditional: True
    ]
  ]
  train:[
    n_iter: 50000
    val_freq: 500
    save_checkpoint_freq: 1000.0
    print_freq: 250
    optimizer:[
      type: adam
      lr: 0.0001
    ]
    ema_scheduler:[
      step_start_ema: 5000
      update_ema_every: 1
      ema_decay: 0.9999
    ]
  ]
  wandb:[
    project: sr_dMRI
  ]
  distributed: True
  log_wandb_ckpt: False
  log_eval: False
  enable_wandb: False

24-12-11 16:40:15.013 - INFO: Dataset [DMRIdataset_3C_Crop - MGH_train] is created.
24-12-11 16:41:09.628 - INFO: Dataset [DMRIdataset_val_3C_Crop - MGH_val] is created.
24-12-11 16:41:09.629 - INFO: Initial Dataset Finished
24-12-11 16:41:10.568 - INFO: Initialization method [orthogonal]
24-12-11 16:41:13.836 - INFO: Network G structure: DataParallel - GaussianDiffusion, with parameters: 97,805,185
24-12-11 16:41:13.836 - INFO: GaussianDiffusion(
  (denoise_fn): UNet(
    (noise_level_mlp): Sequential(
      (0): PositionalEncoding()
      (1): Linear(in_features=64, out_features=256, bias=True)
      (2): Swish()
      (3): Linear(in_features=256, out_features=64, bias=True)
    )
    (downs): ModuleList(
      (0): Conv2d(4, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1-2): 2 x ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=64, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 64, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 64, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
      )
      (3): Downsample(
        (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      )
      (4): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=128, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 64, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (5): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=128, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
      )
      (6): Downsample(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      )
      (7): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=256, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (8): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=256, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
      )
      (9): Downsample(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      )
      (10): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
        )
        (attn): SelfAttention(
          (norm): GroupNorm(32, 512, eps=1e-05, affine=True)
          (qkv): Conv2d(512, 1536, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (out): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (11): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
        (attn): SelfAttention(
          (norm): GroupNorm(32, 512, eps=1e-05, affine=True)
          (qkv): Conv2d(512, 1536, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (out): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (12): Downsample(
        (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      )
      (13-14): 2 x ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
      )
    )
    (mid): ModuleList(
      (0): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
        (attn): SelfAttention(
          (norm): GroupNorm(32, 512, eps=1e-05, affine=True)
          (qkv): Conv2d(512, 1536, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (out): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (1): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Identity()
        )
      )
    )
    (ups): ModuleList(
      (0-2): 3 x ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 1024, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(1024, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (3): Upsample(
        (up): Upsample(scale_factor=2.0, mode='nearest')
        (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (4-5): 2 x ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 1024, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(1024, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1))
        )
        (attn): SelfAttention(
          (norm): GroupNorm(32, 512, eps=1e-05, affine=True)
          (qkv): Conv2d(512, 1536, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (out): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (6): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=512, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 768, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(768, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(768, 512, kernel_size=(1, 1), stride=(1, 1))
        )
        (attn): SelfAttention(
          (norm): GroupNorm(32, 512, eps=1e-05, affine=True)
          (qkv): Conv2d(512, 1536, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (out): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (7): Upsample(
        (up): Upsample(scale_factor=2.0, mode='nearest')
        (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (8): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=256, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 768, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(768, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(768, 256, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (9): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=256, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 512, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(512, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (10): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=256, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 384, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(384, 256, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (11): Upsample(
        (up): Upsample(scale_factor=2.0, mode='nearest')
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (12): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=128, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 384, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(384, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(384, 128, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (13): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=128, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 256, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (14): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=128, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 192, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(192, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(192, 128, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (15): Upsample(
        (up): Upsample(scale_factor=2.0, mode='nearest')
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (16): ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=64, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 192, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(192, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 64, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(192, 64, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (17-18): 2 x ResnetBlocWithAttn(
        (res_block): ResnetBlock(
          (noise_func): FeatureWiseAffine(
            (noise_func): Sequential(
              (0): Linear(in_features=64, out_features=64, bias=True)
            )
          )
          (block1): Block(
            (block): Sequential(
              (0): GroupNorm(32, 128, eps=1e-05, affine=True)
              (1): Swish()
              (2): Identity()
              (3): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (block2): Block(
            (block): Sequential(
              (0): GroupNorm(32, 64, eps=1e-05, affine=True)
              (1): Swish()
              (2): Dropout(p=0.2, inplace=False)
              (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
          )
          (res_conv): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1))
        )
      )
    )
    (final_conv): Block(
      (block): Sequential(
        (0): GroupNorm(32, 64, eps=1e-05, affine=True)
        (1): Swish()
        (2): Identity()
        (3): Conv2d(64, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
    )
  )
  (loss_func): L1Loss()
)
24-12-11 16:41:13.838 - INFO: Model [DDPM] is created.
24-12-11 16:41:13.838 - INFO: Initial Model Finished
24-12-11 16:52:21.754 - INFO: <epoch:  1, iter:     250> l_pix: 1.9430e-01 
24-12-11 17:03:17.315 - INFO: <epoch:  1, iter:     500> l_pix: 6.6722e-02 
24-12-11 17:07:16.635 - INFO: # Validation # PSNR: 2.5943e+01
24-12-11 17:07:16.635 - INFO: <epoch:  1, iter:     500> psnr: 2.5943e+01
24-12-11 17:17:57.286 - INFO: <epoch:  1, iter:     750> l_pix: 6.1275e-02 
24-12-11 17:28:51.361 - INFO: <epoch:  2, iter:   1,000> l_pix: 1.4592e-01 
24-12-11 17:32:57.529 - INFO: # Validation # PSNR: 2.6850e+01
24-12-11 17:32:57.530 - INFO: <epoch:  2, iter:   1,000> psnr: 2.6850e+01
24-12-11 17:32:57.530 - INFO: Saving models and training states.
24-12-11 17:32:58.648 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I1000_E2_gen.pth] ...
24-12-11 17:43:43.861 - INFO: <epoch:  2, iter:   1,250> l_pix: 5.2762e-02 
24-12-11 17:54:30.097 - INFO: <epoch:  2, iter:   1,500> l_pix: 4.7775e-02 
24-12-11 17:58:30.992 - INFO: # Validation # PSNR: 2.5417e+01
24-12-11 17:58:30.993 - INFO: <epoch:  2, iter:   1,500> psnr: 2.5417e+01
24-12-11 18:09:25.270 - INFO: <epoch:  3, iter:   1,750> l_pix: 4.5506e-02 
24-12-11 18:20:10.325 - INFO: <epoch:  3, iter:   2,000> l_pix: 4.6448e-02 
24-12-11 18:24:09.629 - INFO: # Validation # PSNR: 2.1028e+01
24-12-11 18:24:09.630 - INFO: <epoch:  3, iter:   2,000> psnr: 2.1028e+01
24-12-11 18:24:09.631 - INFO: Saving models and training states.
24-12-11 18:24:10.878 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I2000_E3_gen.pth] ...
24-12-11 18:35:03.675 - INFO: <epoch:  3, iter:   2,250> l_pix: 3.6470e-02 
24-12-11 18:46:02.551 - INFO: <epoch:  4, iter:   2,500> l_pix: 4.0913e-02 
24-12-11 18:50:03.136 - INFO: # Validation # PSNR: 2.2825e+01
24-12-11 18:50:03.136 - INFO: <epoch:  4, iter:   2,500> psnr: 2.2825e+01
24-12-11 19:00:51.443 - INFO: <epoch:  4, iter:   2,750> l_pix: 3.4811e-02 
24-12-11 19:11:39.948 - INFO: <epoch:  4, iter:   3,000> l_pix: 6.0187e-02 
24-12-11 19:15:43.214 - INFO: # Validation # PSNR: 2.9476e+01
24-12-11 19:15:43.214 - INFO: <epoch:  4, iter:   3,000> psnr: 2.9476e+01
24-12-11 19:15:43.215 - INFO: Saving models and training states.
24-12-11 19:15:44.447 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I3000_E4_gen.pth] ...
24-12-11 19:26:39.862 - INFO: <epoch:  5, iter:   3,250> l_pix: 2.6698e-02 
24-12-11 19:37:30.941 - INFO: <epoch:  5, iter:   3,500> l_pix: 2.8686e-02 
24-12-11 19:41:34.747 - INFO: # Validation # PSNR: 2.3787e+01
24-12-11 19:41:34.748 - INFO: <epoch:  5, iter:   3,500> psnr: 2.3787e+01
24-12-11 19:52:23.251 - INFO: <epoch:  5, iter:   3,750> l_pix: 7.2347e-02 
24-12-11 20:03:21.699 - INFO: <epoch:  6, iter:   4,000> l_pix: 4.4547e-02 
24-12-11 20:07:21.450 - INFO: # Validation # PSNR: 2.0752e+01
24-12-11 20:07:21.451 - INFO: <epoch:  6, iter:   4,000> psnr: 2.0752e+01
24-12-11 20:07:21.451 - INFO: Saving models and training states.
24-12-11 20:07:22.901 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I4000_E6_gen.pth] ...
24-12-11 20:18:12.046 - INFO: <epoch:  6, iter:   4,250> l_pix: 4.3667e-02 
24-12-11 20:28:58.884 - INFO: <epoch:  6, iter:   4,500> l_pix: 2.3156e-02 
24-12-11 20:32:59.476 - INFO: # Validation # PSNR: 3.0414e+01
24-12-11 20:32:59.477 - INFO: <epoch:  6, iter:   4,500> psnr: 3.0414e+01
24-12-11 20:43:55.339 - INFO: <epoch:  7, iter:   4,750> l_pix: 1.9626e-02 
24-12-11 20:54:39.793 - INFO: <epoch:  7, iter:   5,000> l_pix: 2.4919e-02 
24-12-11 20:58:42.280 - INFO: # Validation # PSNR: 3.0921e+01
24-12-11 20:58:42.280 - INFO: <epoch:  7, iter:   5,000> psnr: 3.0921e+01
24-12-11 20:58:42.281 - INFO: Saving models and training states.
24-12-11 20:58:43.837 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I5000_E7_gen.pth] ...
24-12-11 21:09:29.927 - INFO: <epoch:  7, iter:   5,250> l_pix: 2.1855e-02 
24-12-11 21:20:28.322 - INFO: <epoch:  8, iter:   5,500> l_pix: 2.3050e-02 
24-12-11 21:24:28.440 - INFO: # Validation # PSNR: 2.9369e+01
24-12-11 21:24:28.440 - INFO: <epoch:  8, iter:   5,500> psnr: 2.9369e+01
24-12-11 21:35:11.611 - INFO: <epoch:  8, iter:   5,750> l_pix: 2.8696e-02 
24-12-11 21:45:51.860 - INFO: <epoch:  8, iter:   6,000> l_pix: 2.5849e-02 
24-12-11 21:50:09.182 - INFO: # Validation # PSNR: 3.2732e+01
24-12-11 21:50:09.183 - INFO: <epoch:  8, iter:   6,000> psnr: 3.2732e+01
24-12-11 21:50:09.190 - INFO: Saving models and training states.
24-12-11 21:50:11.325 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I6000_E8_gen.pth] ...
24-12-11 22:01:03.446 - INFO: <epoch:  9, iter:   6,250> l_pix: 1.7574e-02 
24-12-11 22:11:46.749 - INFO: <epoch:  9, iter:   6,500> l_pix: 1.8100e-02 
24-12-11 22:16:06.318 - INFO: # Validation # PSNR: 3.4025e+01
24-12-11 22:16:06.318 - INFO: <epoch:  9, iter:   6,500> psnr: 3.4025e+01
24-12-11 22:26:49.680 - INFO: <epoch:  9, iter:   6,750> l_pix: 1.7268e-02 
24-12-11 22:37:42.261 - INFO: <epoch: 10, iter:   7,000> l_pix: 2.0329e-02 
24-12-11 22:41:56.901 - INFO: # Validation # PSNR: 3.5111e+01
24-12-11 22:41:56.901 - INFO: <epoch: 10, iter:   7,000> psnr: 3.5111e+01
24-12-11 22:41:56.902 - INFO: Saving models and training states.
24-12-11 22:41:58.246 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I7000_E10_gen.pth] ...
24-12-11 22:52:38.765 - INFO: <epoch: 10, iter:   7,250> l_pix: 1.7136e-02 
24-12-11 23:03:19.481 - INFO: <epoch: 10, iter:   7,500> l_pix: 1.2098e-02 
24-12-11 23:07:40.704 - INFO: # Validation # PSNR: 3.3487e+01
24-12-11 23:07:40.705 - INFO: <epoch: 10, iter:   7,500> psnr: 3.3487e+01
24-12-11 23:18:32.844 - INFO: <epoch: 11, iter:   7,750> l_pix: 2.6567e-02 
24-12-11 23:29:12.642 - INFO: <epoch: 11, iter:   8,000> l_pix: 4.5618e-02 
24-12-11 23:33:29.975 - INFO: # Validation # PSNR: 3.6206e+01
24-12-11 23:33:29.976 - INFO: <epoch: 11, iter:   8,000> psnr: 3.6206e+01
24-12-11 23:33:29.977 - INFO: Saving models and training states.
24-12-11 23:33:31.278 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I8000_E11_gen.pth] ...
24-12-11 23:44:09.738 - INFO: <epoch: 11, iter:   8,250> l_pix: 2.4923e-02 
24-12-11 23:54:59.632 - INFO: <epoch: 12, iter:   8,500> l_pix: 1.7297e-02 
24-12-11 23:59:16.228 - INFO: # Validation # PSNR: 3.5984e+01
24-12-11 23:59:16.228 - INFO: <epoch: 12, iter:   8,500> psnr: 3.5984e+01
24-12-12 00:09:55.152 - INFO: <epoch: 12, iter:   8,750> l_pix: 1.3075e-02 
24-12-12 00:20:32.715 - INFO: <epoch: 12, iter:   9,000> l_pix: 3.3532e-02 
24-12-12 00:24:50.008 - INFO: # Validation # PSNR: 3.7519e+01
24-12-12 00:24:50.009 - INFO: <epoch: 12, iter:   9,000> psnr: 3.7519e+01
24-12-12 00:24:50.009 - INFO: Saving models and training states.
24-12-12 00:24:51.313 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I9000_E12_gen.pth] ...
24-12-12 00:35:45.525 - INFO: <epoch: 13, iter:   9,250> l_pix: 4.4717e-02 
24-12-12 00:46:23.360 - INFO: <epoch: 13, iter:   9,500> l_pix: 4.7040e-02 
24-12-12 00:50:39.448 - INFO: # Validation # PSNR: 3.7552e+01
24-12-12 00:50:39.449 - INFO: <epoch: 13, iter:   9,500> psnr: 3.7552e+01
24-12-12 01:01:20.951 - INFO: <epoch: 13, iter:   9,750> l_pix: 2.2314e-02 
24-12-12 01:12:12.454 - INFO: <epoch: 14, iter:  10,000> l_pix: 1.5027e-02 
24-12-12 01:16:28.821 - INFO: # Validation # PSNR: 3.7757e+01
24-12-12 01:16:28.821 - INFO: <epoch: 14, iter:  10,000> psnr: 3.7757e+01
24-12-12 01:16:28.825 - INFO: Saving models and training states.
24-12-12 01:16:30.103 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I10000_E14_gen.pth] ...
24-12-12 01:27:06.764 - INFO: <epoch: 14, iter:  10,250> l_pix: 1.9745e-02 
24-12-12 01:37:47.718 - INFO: <epoch: 14, iter:  10,500> l_pix: 2.6780e-02 
24-12-12 01:42:03.841 - INFO: # Validation # PSNR: 3.7753e+01
24-12-12 01:42:03.842 - INFO: <epoch: 14, iter:  10,500> psnr: 3.7753e+01
24-12-12 01:52:53.288 - INFO: <epoch: 15, iter:  10,750> l_pix: 2.0422e-02 
24-12-12 02:03:31.764 - INFO: <epoch: 15, iter:  11,000> l_pix: 1.7516e-02 
24-12-12 02:07:47.932 - INFO: # Validation # PSNR: 3.7230e+01
24-12-12 02:07:47.933 - INFO: <epoch: 15, iter:  11,000> psnr: 3.7230e+01
24-12-12 02:07:47.940 - INFO: Saving models and training states.
24-12-12 02:07:49.221 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I11000_E15_gen.pth] ...
24-12-12 02:18:27.984 - INFO: <epoch: 15, iter:  11,250> l_pix: 1.2254e-02 
24-12-12 02:29:18.524 - INFO: <epoch: 16, iter:  11,500> l_pix: 9.6290e-03 
24-12-12 02:33:39.486 - INFO: # Validation # PSNR: 3.7570e+01
24-12-12 02:33:39.487 - INFO: <epoch: 16, iter:  11,500> psnr: 3.7570e+01
24-12-12 02:44:18.674 - INFO: <epoch: 16, iter:  11,750> l_pix: 1.4023e-02 
24-12-12 02:54:58.216 - INFO: <epoch: 16, iter:  12,000> l_pix: 1.3474e-02 
24-12-12 02:59:12.768 - INFO: # Validation # PSNR: 3.7872e+01
24-12-12 02:59:12.769 - INFO: <epoch: 16, iter:  12,000> psnr: 3.7872e+01
24-12-12 02:59:12.769 - INFO: Saving models and training states.
24-12-12 02:59:14.088 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I12000_E16_gen.pth] ...
24-12-12 03:10:04.451 - INFO: <epoch: 17, iter:  12,250> l_pix: 1.1931e-02 
24-12-12 03:20:44.682 - INFO: <epoch: 17, iter:  12,500> l_pix: 1.2606e-02 
24-12-12 03:25:03.061 - INFO: # Validation # PSNR: 3.7465e+01
24-12-12 03:25:03.061 - INFO: <epoch: 17, iter:  12,500> psnr: 3.7465e+01
24-12-12 03:35:43.048 - INFO: <epoch: 17, iter:  12,750> l_pix: 1.7012e-02 
24-12-12 03:46:29.132 - INFO: <epoch: 18, iter:  13,000> l_pix: 1.2783e-02 
24-12-12 03:50:43.727 - INFO: # Validation # PSNR: 3.7784e+01
24-12-12 03:50:43.728 - INFO: <epoch: 18, iter:  13,000> psnr: 3.7784e+01
24-12-12 03:50:43.728 - INFO: Saving models and training states.
24-12-12 03:50:44.977 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I13000_E18_gen.pth] ...
24-12-12 04:01:22.131 - INFO: <epoch: 18, iter:  13,250> l_pix: 2.3054e-02 
24-12-12 04:12:02.935 - INFO: <epoch: 18, iter:  13,500> l_pix: 1.4487e-02 
24-12-12 04:16:20.684 - INFO: # Validation # PSNR: 3.7691e+01
24-12-12 04:16:20.685 - INFO: <epoch: 18, iter:  13,500> psnr: 3.7691e+01
24-12-12 04:27:11.789 - INFO: <epoch: 19, iter:  13,750> l_pix: 1.1423e-02 
24-12-12 04:37:55.748 - INFO: <epoch: 19, iter:  14,000> l_pix: 1.2298e-02 
24-12-12 04:42:13.910 - INFO: # Validation # PSNR: 3.7893e+01
24-12-12 04:42:13.911 - INFO: <epoch: 19, iter:  14,000> psnr: 3.7893e+01
24-12-12 04:42:13.911 - INFO: Saving models and training states.
24-12-12 04:42:15.223 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I14000_E19_gen.pth] ...
24-12-12 04:52:53.033 - INFO: <epoch: 19, iter:  14,250> l_pix: 2.0023e-01 
24-12-12 05:03:42.741 - INFO: <epoch: 20, iter:  14,500> l_pix: 2.3814e-02 
24-12-12 05:08:02.559 - INFO: # Validation # PSNR: 3.7598e+01
24-12-12 05:08:02.560 - INFO: <epoch: 20, iter:  14,500> psnr: 3.7598e+01
24-12-12 05:18:40.407 - INFO: <epoch: 20, iter:  14,750> l_pix: 9.4974e-03 
24-12-12 05:29:17.811 - INFO: <epoch: 20, iter:  15,000> l_pix: 3.1257e-02 
24-12-12 05:33:33.546 - INFO: # Validation # PSNR: 3.7635e+01
24-12-12 05:33:33.547 - INFO: <epoch: 20, iter:  15,000> psnr: 3.7635e+01
24-12-12 05:33:33.548 - INFO: Saving models and training states.
24-12-12 05:33:34.834 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I15000_E20_gen.pth] ...
24-12-12 05:44:23.630 - INFO: <epoch: 21, iter:  15,250> l_pix: 1.2000e-02 
24-12-12 05:55:00.869 - INFO: <epoch: 21, iter:  15,500> l_pix: 2.0168e-02 
24-12-12 05:59:19.778 - INFO: # Validation # PSNR: 3.7762e+01
24-12-12 05:59:19.779 - INFO: <epoch: 21, iter:  15,500> psnr: 3.7762e+01
24-12-12 06:09:59.413 - INFO: <epoch: 21, iter:  15,750> l_pix: 1.1111e-02 
24-12-12 06:20:52.435 - INFO: <epoch: 22, iter:  16,000> l_pix: 1.0925e-02 
24-12-12 06:25:11.341 - INFO: # Validation # PSNR: 3.7732e+01
24-12-12 06:25:11.341 - INFO: <epoch: 22, iter:  16,000> psnr: 3.7732e+01
24-12-12 06:25:11.342 - INFO: Saving models and training states.
24-12-12 06:25:12.604 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I16000_E22_gen.pth] ...
24-12-12 06:35:51.711 - INFO: <epoch: 22, iter:  16,250> l_pix: 1.1382e-02 
24-12-12 06:46:31.274 - INFO: <epoch: 22, iter:  16,500> l_pix: 8.4399e-03 
24-12-12 06:50:54.557 - INFO: # Validation # PSNR: 3.7795e+01
24-12-12 06:50:54.558 - INFO: <epoch: 22, iter:  16,500> psnr: 3.7795e+01
24-12-12 07:01:46.235 - INFO: <epoch: 23, iter:  16,750> l_pix: 9.1699e-03 
24-12-12 07:12:28.123 - INFO: <epoch: 23, iter:  17,000> l_pix: 1.2228e-02 
24-12-12 07:16:44.617 - INFO: # Validation # PSNR: 3.7630e+01
24-12-12 07:16:44.617 - INFO: <epoch: 23, iter:  17,000> psnr: 3.7630e+01
24-12-12 07:16:44.618 - INFO: Saving models and training states.
24-12-12 07:16:46.255 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I17000_E23_gen.pth] ...
24-12-12 07:27:24.026 - INFO: <epoch: 23, iter:  17,250> l_pix: 1.4964e-02 
24-12-12 07:38:13.764 - INFO: <epoch: 24, iter:  17,500> l_pix: 1.0631e-02 
24-12-12 07:42:31.115 - INFO: # Validation # PSNR: 3.7947e+01
24-12-12 07:42:31.116 - INFO: <epoch: 24, iter:  17,500> psnr: 3.7947e+01
24-12-12 07:53:10.028 - INFO: <epoch: 24, iter:  17,750> l_pix: 1.0429e-02 
24-12-12 08:03:48.117 - INFO: <epoch: 24, iter:  18,000> l_pix: 1.7211e-02 
24-12-12 08:08:07.228 - INFO: # Validation # PSNR: 3.7864e+01
24-12-12 08:08:07.229 - INFO: <epoch: 24, iter:  18,000> psnr: 3.7864e+01
24-12-12 08:08:07.230 - INFO: Saving models and training states.
24-12-12 08:08:08.541 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I18000_E24_gen.pth] ...
24-12-12 08:18:57.269 - INFO: <epoch: 25, iter:  18,250> l_pix: 1.3801e-02 
24-12-12 08:29:35.671 - INFO: <epoch: 25, iter:  18,500> l_pix: 8.6526e-03 
24-12-12 08:33:56.020 - INFO: # Validation # PSNR: 3.7659e+01
24-12-12 08:33:56.021 - INFO: <epoch: 25, iter:  18,500> psnr: 3.7659e+01
24-12-12 08:44:36.556 - INFO: <epoch: 25, iter:  18,750> l_pix: 1.1330e-02 
24-12-12 08:55:25.520 - INFO: <epoch: 26, iter:  19,000> l_pix: 1.1746e-02 
24-12-12 08:59:48.336 - INFO: # Validation # PSNR: 3.7465e+01
24-12-12 08:59:48.336 - INFO: <epoch: 26, iter:  19,000> psnr: 3.7465e+01
24-12-12 08:59:48.344 - INFO: Saving models and training states.
24-12-12 08:59:49.615 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I19000_E26_gen.pth] ...
24-12-12 09:10:30.097 - INFO: <epoch: 26, iter:  19,250> l_pix: 9.2799e-03 
24-12-12 09:21:07.160 - INFO: <epoch: 26, iter:  19,500> l_pix: 1.1973e-02 
24-12-12 09:25:23.000 - INFO: # Validation # PSNR: 3.7985e+01
24-12-12 09:25:23.000 - INFO: <epoch: 26, iter:  19,500> psnr: 3.7985e+01
24-12-12 09:36:13.603 - INFO: <epoch: 27, iter:  19,750> l_pix: 7.2174e-03 
24-12-12 09:46:50.216 - INFO: <epoch: 27, iter:  20,000> l_pix: 3.9853e-02 
24-12-12 09:51:08.594 - INFO: # Validation # PSNR: 3.7588e+01
24-12-12 09:51:08.595 - INFO: <epoch: 27, iter:  20,000> psnr: 3.7588e+01
24-12-12 09:51:08.596 - INFO: Saving models and training states.
24-12-12 09:51:09.931 - INFO: Saved model in [experiments/SR3_241211_163915/checkpoint/I20000_E27_gen.pth] ...
